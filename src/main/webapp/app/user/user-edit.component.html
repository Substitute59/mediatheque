<form (ngSubmit)="userEdit()" [formGroup]="userEditForm" class="p-8">
    <div class="bg-surface-0 dark:bg-surface-900 p-8 md:p-12 shadow-sm rounded-2xl w-full max-w-sm mx-auto flex flex-col gap-8">
        <div class="flex flex-col items-center gap-4">
            <div class="flex flex-col items-center gap-2 w-full">
                <div class="text-surface-900 dark:text-surface-0 text-2xl font-semibold leading-tight text-center w-full" i18n="@@user.edit.form.title">Modifiez votre compte</div>
            </div>
        </div>
        @if (user$ | async; as user) {
            <div class="flex flex-col gap-6 w-full">
                <div class="flex flex-col gap-2 w-full">
                    <p class="text-surface-900 dark:text-surface-0 font-medium leading-normal" i18n="@@user.edit.label.email">Email</p>
                    <p>{{ user.username }}</p>
                </div>
                <div class="flex flex-col gap-2 w-full">
                    <label for="password" class="text-surface-900 dark:text-surface-0 font-medium leading-normal" i18n="@@user.edit.form.password">Mot de passe</label>
                    <input pInputText id="password" name="password" formControlName="password" type="password" required i18n-placeholder="@@user.edit.form.password" placeholder="Mot de passe" class="w-full px-3 py-2 shadow-sm rounded-lg" />
                    @if (errorField === 'password' && errorMessage) {
                        <p class="text-sm text-red-500 mt-2">{{ errorMessage }}</p>
                    }
                </div>
                <div class="flex flex-col gap-2 w-full">
                    <label for="avatar" class="text-surface-900 dark:text-surface-0 font-medium leading-normal" i18n="@@user.edit.form.avatar">Avatar</label>
                    <p-fileupload
                        mode="basic"
                        name="avatar"
                        accept="image/*"
                        maxFileSize="5000000"
                        (onSelect)="onFileSelect($event)"
                        chooseIcon="pi pi-upload"
                        auto="false"
                    />
                    <img class="w-50" [src]="user.avatar ? environment.apiPath + '/uploads/' + user.avatar : ''" alt="Photo de profil" i18n-alt="@@user.edit.form.avatar.alt">
                </div>
            </div>
        }
        <button pButton class="w-full py-2 rounded-lg flex justify-center items-center gap-2">
            <i pButtonIcon class="pi pi-user text-base! leading-normal!"></i>
            <span pButtonLabel i18n="@@user.edit.form.update">Modifier le compte</span>
        </button>
        <p-toast />
    </div>
</form>
